import{a1 as S,C as z,g as H,H as M,h as P,D as Z,G as J,F as W,a5 as X}from"./element-plus-BOMqSMu4.js";import{_ as Y}from"./index.vue_vue_type_style_index_0_lang-Bn866MxG.js";import{_ as ee}from"./index.vue_vue_type_style_index_0_lang-BHe48Qr2.js";import{g as te}from"./tenant_exam_chapter-BMC_APIL.js";import{b as le,c as oe,d as se}from"./tenant_exam_question-B2Ksr1j0.js";import{a as ae}from"./useDictOptions-Dk9jd2iD.js";import{E as g}from"./index-CJYi2pTy.js";import{d as ne,Z as b,s as re,w as ie,o as p,c as _,V as a,M as n,u as o,a as i,U as v,aa as y,S as m,L as N,T as D}from"./@vue-DWQ9eUI2.js";const de={style:{width:"100%"}},ue={style:{width:"100%"}},pe={class:"",style:{width:"100%"}},me={class:"padding-right20 display-flex-start-center"},ce={class:"padding-right"},_e={class:"display-flex-start-center"},fe={class:"margin-top10"},he={class:"display-flex"},Ee=ne({__name:"CheckBoxOption",props:{id:{},libraryUid:{}},emits:["success"],setup(O,{emit:I}){const T=I,c=O,t=b({id:c.id||0,chapterUid:"",libraryUid:"",tenant_exam_library_uid:c.libraryUid,title:"",score:1,analysis:"",is_show:1,exam_type:2,sort:0,level:1,chapter_uid:"",selectAnswer:"",answer:[],option:[{check:g.A,title:"请输入选项值",is_check:!1}]}),{dictData:w}=ae("show_status,level"),k=b([]),V=re(),q=b({title:[{required:!0,message:"请输入试题题干",trigger:["blur"]}],is_show:[{required:!0,message:"请选择试题显示状态",trigger:["blur"]}],sort:[{required:!0,message:"请输入试题显示权重",trigger:["blur"]}],score:[{required:!0,message:"请输入试题积分",trigger:["blur"]},{type:"number",message:"请输入大于0的整数",min:0}],answer:[{required:!0,message:"请选勾选题答案",trigger:["blur"]},{validator:(s,e,r)=>{e.length<1?r(new Error("请选勾选题答案")):r()},trigger:["blur","change"]}],level:[{required:!0,message:"请勾选试题难度",trigger:["blur"]}]});ie(()=>c.id,(s,e)=>{console.log("新值:",s),console.log("旧值:",e),s!==e&&A()});const B=async()=>{var e;console.log("saveForm",t);const s={...t};await((e=V.value)==null?void 0:e.validate(r=>{r?(t.id?le(s):oe(s),T("success",s)):console.log("error submit!!",s)}))},F=s=>{t.chapter_uid=s[1]},R=()=>{const s=Object.keys(g).filter(r=>isNaN(Number(r))),e=t.option.length;s[e]!==void 0&&t.option.push({check:s[e],title:"请输入选项值",is_check:!1})},L=s=>{t.option.splice(s,1),j()},j=()=>{const s=Object.keys(g).filter(r=>isNaN(Number(r))),e=[];for(let r=0;r<t.option.length;r++)e.push({title:t.option[r].title,check:s[r],is_check:t.option[r].is_check});t.option=e},A=async()=>{const s=await se({id:c.id});Object.assign(t,s),t.selectAnswer=s.answer};return(async()=>{te({tenant_exam_library_uid:t.tenant_exam_library_uid}).then(s=>{Object.assign(k,s)})})(),(s,e)=>{const r=S,d=z,x=ee,C=H,E=J,U=M,Q=Y,G=W,f=P,$=X,K=Z;return p(),_("div",null,[a(K,{"label-width":"100px",model:o(t),ref_key:"formRef",ref:V,rules:o(q)},{default:n(()=>[a(d,{label:"试题章节",prop:"chapter_uid"},{default:n(()=>[a(r,{modelValue:o(t).chapter_uid,"onUpdate:modelValue":e[0]||(e[0]=l=>o(t).chapter_uid=l),options:o(k),props:c,style:{width:"100%"},onChange:F},null,8,["modelValue","options","props"])]),_:1}),a(d,{label:"试题题干",prop:"title"},{default:n(()=>[a(x,{modelValue:o(t).title,"onUpdate:modelValue":e[1]||(e[1]=l=>o(t).title=l),height:150,width:"100%"},null,8,["modelValue"])]),_:1}),a(d,{label:"显示权重",prop:"sort"},{default:n(()=>[i("div",de,[a(C,{min:0,step:1,modelValue:o(t).sort,"onUpdate:modelValue":e[2]||(e[2]=l=>o(t).sort=l),style:{width:"100%"},clearable:"",placeholder:"请输入"},null,8,["modelValue"]),e[8]||(e[8]=i("div",{class:"form-tips"},"默认为0， 只能为大于0的整数。值越大越排前显示。",-1))])]),_:1}),a(d,{label:"试题积分",prop:"score"},{default:n(()=>[i("div",ue,[a(C,{min:1,step:.01,style:{width:"100%"},modelValue:o(t).score,"onUpdate:modelValue":e[3]||(e[3]=l=>o(t).score=l),clearable:"",placeholder:"请输入"},null,8,["modelValue"]),e[9]||(e[9]=i("div",{class:"form-tips"},"默认为0， 只能为大于0的整数。值越大越排前显示。",-1))])]),_:1}),a(d,{label:"启用状态",prop:"is_show"},{default:n(()=>[a(U,{modelValue:o(t).is_show,"onUpdate:modelValue":e[4]||(e[4]=l=>o(t).is_show=l),placeholder:"请选择"},{default:n(()=>[(p(!0),_(v,null,y(o(w).show_status,(l,u)=>(p(),N(E,{key:u,value:parseInt(l.value),label:parseInt(l.value)},{default:n(()=>[m(D(l.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"试题难度",prop:"level"},{default:n(()=>[a(U,{modelValue:o(t).level,"onUpdate:modelValue":e[5]||(e[5]=l=>o(t).level=l),placeholder:"请选择试题难度"},{default:n(()=>[(p(!0),_(v,null,y(o(w).level,(l,u)=>(p(),N(E,{key:u,value:parseInt(l.value),label:parseInt(l.value)},{default:n(()=>[m(D(l.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"试题解析",prop:"analysis"},{default:n(()=>[a(Q,{modelValue:o(t).analysis,"onUpdate:modelValue":e[6]||(e[6]=l=>o(t).analysis=l),height:150,width:"100%"},null,8,["modelValue"])]),_:1}),a(d,{label:"答案选项"},{default:n(()=>[(p(!0),_(v,null,y(o(t).option,(l,u)=>(p(),_("div",{key:l.check,class:"with100"},[i("div",null,[a($,{modelValue:o(t).answer,"onUpdate:modelValue":e[7]||(e[7]=h=>o(t).answer=h)},{default:n(()=>[i("div",pe,[i("div",me,[i("div",ce,[a(G,{value:l.check,label:"选项"+l.check,size:"large",name:"option_check"},null,8,["value","label"])]),i("div",_e,[a(f,{type:"success",icon:"Plus",link:"",onClick:R},{default:n(()=>e[10]||(e[10]=[m("添加选项 ")])),_:1}),a(f,{type:"danger",icon:"Delete",link:"",onClick:h=>L(u)},{default:n(()=>e[11]||(e[11]=[m("删除选项 ")])),_:2},1032,["onClick"])])])])]),_:2},1032,["modelValue"])]),i("div",fe,[a(x,{modelValue:o(t).option[u].title,"onUpdate:modelValue":h=>o(t).option[u].title=h,height:150,width:"100%"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))]),_:1}),i("div",he,[a(f,{type:"primary",onClick:B},{default:n(()=>e[12]||(e[12]=[m("保存试题")])),_:1}),a(f,{type:"warning"},{default:n(()=>e[13]||(e[13]=[m("重置数据")])),_:1})])]),_:1},8,["model","rules"])])}}});export{Ee as _};
